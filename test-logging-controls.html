<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Console Logging Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .test-result { margin: 10px 0; padding: 10px; }
        .pass { background-color: #d4edda; color: #155724; }
        .fail { background-color: #f8d7da; color: #721c24; }
        button { margin: 5px; padding: 8px 12px; }
        .console-output { background: #f8f9fa; padding: 10px; margin: 10px 0; border-left: 4px solid #007bff; }
    </style>
</head>
<body>
    <h1>Console Logging Control Test</h1>
    
    <div class="test-section">
        <h2>Current Environment</h2>
        <div id="env-info"></div>
    </div>

    <div class="test-section">
        <h2>Console Method Tests</h2>
        <button onclick="testConsoleLog()">Test console.log</button>
        <button onclick="testConsoleInfo()">Test console.info</button>
        <button onclick="testConsoleDebug()">Test console.debug</button>
        <button onclick="testConsoleWarn()">Test console.warn</button>
        <button onclick="testConsoleError()">Test console.error</button>
        <div id="console-test-results"></div>
    </div>

    <div class="test-section">
        <h2>Debug Mode Controls</h2>
        <button onclick="enableDebugURL()">Enable Debug via URL (?debug=1)</button>
        <button onclick="enableDebugLocalStorage()">Enable Debug via localStorage</button>
        <button onclick="disableDebug()">Disable Debug</button>
        <button onclick="checkDebugStatus()">Check Debug Status</button>
        <div id="debug-status"></div>
    </div>

    <div class="test-section">
        <h2>Simulated App Logging Test</h2>
        <button onclick="simulateAppLogging()">Simulate Heavy App Logging</button>
        <button onclick="clearConsole()">Clear Console</button>
        <div id="app-logging-results"></div>
    </div>

    <script>
        // Environment detection
        function updateEnvInfo() {
            document.getElementById('env-info').innerHTML = `
                <strong>Mode:</strong> ${typeof import !== 'undefined' && import.meta?.env?.DEV ? 'Development' : 'Production'}<br>
                <strong>URL:</strong> ${window.location.href}<br>
                <strong>Debug Param:</strong> ${new URLSearchParams(window.location.search).get('debug')}<br>
                <strong>localStorage debugLogs:</strong> ${localStorage.getItem('debugLogs')}<br>
                <strong>Console Methods Status:</strong><br>
                - log: ${typeof console.log === 'function' ? 'function' : 'silenced'}<br>
                - info: ${typeof console.info === 'function' ? 'function' : 'silenced'}<br>
                - debug: ${typeof console.debug === 'function' ? 'function' : 'silenced'}<br>
                - warn: ${typeof console.warn === 'function' ? 'function' : 'active'}<br>
                - error: ${typeof console.error === 'function' ? 'function' : 'active'}
            `;
        }

        // Test individual console methods
        function testConsoleLog() {
            console.log('TEST: This is a console.log message');
            addTestResult('console.log', 'Executed (check browser console)');
        }

        function testConsoleInfo() {
            console.info('TEST: This is a console.info message');
            addTestResult('console.info', 'Executed (check browser console)');
        }

        function testConsoleDebug() {
            console.debug('TEST: This is a console.debug message');
            addTestResult('console.debug', 'Executed (check browser console)');
        }

        function testConsoleWarn() {
            console.warn('TEST: This is a console.warn message');
            addTestResult('console.warn', 'Executed (should be visible in console)');
        }

        function testConsoleError() {
            console.error('TEST: This is a console.error message');
            addTestResult('console.error', 'Executed (should be visible in console)');
        }

        function addTestResult(method, status) {
            const results = document.getElementById('console-test-results');
            results.innerHTML += `<div class="test-result pass">${method}: ${status}</div>`;
        }

        // Debug mode controls
        function enableDebugURL() {
            const url = new URL(window.location);
            url.searchParams.set('debug', '1');
            window.location.href = url.toString();
        }

        function enableDebugLocalStorage() {
            localStorage.setItem('debugLogs', 'true');
            location.reload();
        }

        function disableDebug() {
            localStorage.removeItem('debugLogs');
            const url = new URL(window.location);
            url.searchParams.delete('debug');
            window.location.href = url.toString();
        }

        function checkDebugStatus() {
            const params = new URLSearchParams(window.location.search);
            const debugURL = params.get('debug') === '1';
            const debugLS = localStorage.getItem('debugLogs') === 'true';
            const debugOn = debugURL || debugLS;
            
            document.getElementById('debug-status').innerHTML = `
                <div class="test-result ${debugOn ? 'pass' : 'fail'}">
                    <strong>Debug Status:</strong> ${debugOn ? 'ENABLED' : 'DISABLED'}<br>
                    <strong>Via URL:</strong> ${debugURL}<br>
                    <strong>Via localStorage:</strong> ${debugLS}
                </div>
            `;
        }

        // Simulate heavy app logging
        function simulateAppLogging() {
            const startTime = performance.now();
            let logCount = 0;
            
            // Simulate the type of logging that was causing issues
            const platforms = ['instagram', 'twitter', 'facebook'];
            const logTypes = [
                '[MainDashboard] 🔍 BACKEND SYNC: Received processing status data',
                '[UsageContext] 🔄 Refreshing usage for userId',
                '🔥 TIMER SYNC: platform has X minutes remaining',
                '🔍 PLATFORM STATUS CHECK: platform - storage:true context:false',
                '[MainDashboard] 🔍 FACEBOOK LOCALSTORAGE MONITOR: Found keys'
            ];

            // Run logging simulation for 2 seconds
            const interval = setInterval(() => {
                platforms.forEach(platform => {
                    logTypes.forEach(logType => {
                        console.log(`${logType.replace('platform', platform)}: ${Date.now()}`);
                        console.info(`INFO: ${logType.replace('platform', platform)}`);
                        console.debug(`DEBUG: ${logType.replace('platform', platform)}`);
                        logCount += 3;
                    });
                });
            }, 100); // Every 100ms

            setTimeout(() => {
                clearInterval(interval);
                const endTime = performance.now();
                const duration = endTime - startTime;
                
                document.getElementById('app-logging-results').innerHTML = `
                    <div class="test-result ${logCount < 100 ? 'pass' : 'fail'}">
                        <strong>Simulation Complete:</strong><br>
                        - Duration: ${duration.toFixed(2)}ms<br>
                        - Attempted logs: ${logCount}<br>
                        - Status: ${logCount < 100 ? 'SILENCED (GOOD)' : 'NOT SILENCED (BAD)'}<br>
                        - Check browser console to verify actual output
                    </div>
                `;
            }, 2000);

            document.getElementById('app-logging-results').innerHTML = `
                <div class="console-output">Running logging simulation... Check browser console for output.</div>
            `;
        }

        function clearConsole() {
            console.clear();
        }

        // Initialize
        updateEnvInfo();
        checkDebugStatus();

        // Update info periodically
        setInterval(updateEnvInfo, 1000);
    </script>
</body>
</html>
